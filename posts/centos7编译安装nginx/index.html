<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>centos7编译安装nginx | 笔记</title>
<meta name="keywords" content="centos, nginx">
<meta name="description" content="ps : nginx安装在/opt/local/nginx里
1.安装编译安装依赖的类库和包
如果需要编译MySQL和PHP，就安装这些
yum install -y make apr* autoconf automake curl curl-devel gcc gcc-c&#43;&#43; gtk&#43;-devel zlib-devel openssl openssl-devel pcre-devel gd kernel keyutils patch perl kernel-headers compat* cpp glibc libgomp libstdc&#43;&#43;-devel keyutils-libs-devel libsepol-devel libselinux-devel krb5-devel libXpm* freetype freetype-devel freetype* fontconfig fontconfig-devel libjpeg* libpng* php-common php-gd gettext gettext-devel ncurses* libtool* libxml2 libxml2-devel patch policycoreutils bison 如果只编译nginx，就安装这些
yum install gcc gcc-c&#43;&#43; autoconf automake zlib zlib-devel openssl openssl-devel pcre-devel 2.编译安装pcre
PS：Pcre版本不能太高，8最好，要不编译不能通过
mkdir /usr/local/pcre #创建安装目录 tar zxvf pcre-8.">
<meta name="author" content="ZhaoGuibin">
<link rel="canonical" href="http://zhaoguibin.me/posts/centos7%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85nginx/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.992a00f8084499f09735e47b38e064f4f753a5bd701c7c3e4903bb2b84ef2e3b.css" integrity="sha256-mSoA&#43;AhEmfCXNeR7OOBk9PdTpb1wHHw&#43;SQO7K4TvLjs=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://zhaoguibin.me/assets/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://zhaoguibin.me/assets/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://zhaoguibin.me/assets/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://zhaoguibin.me/apple-touch-icon.png">
<link rel="mask-icon" href="http://zhaoguibin.me/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="centos7编译安装nginx" />
<meta property="og:description" content="ps : nginx安装在/opt/local/nginx里
1.安装编译安装依赖的类库和包
如果需要编译MySQL和PHP，就安装这些
yum install -y make apr* autoconf automake curl curl-devel gcc gcc-c&#43;&#43; gtk&#43;-devel zlib-devel openssl openssl-devel pcre-devel gd kernel keyutils patch perl kernel-headers compat* cpp glibc libgomp libstdc&#43;&#43;-devel keyutils-libs-devel libsepol-devel libselinux-devel krb5-devel libXpm* freetype freetype-devel freetype* fontconfig fontconfig-devel libjpeg* libpng* php-common php-gd gettext gettext-devel ncurses* libtool* libxml2 libxml2-devel patch policycoreutils bison 如果只编译nginx，就安装这些
yum install gcc gcc-c&#43;&#43; autoconf automake zlib zlib-devel openssl openssl-devel pcre-devel 2.编译安装pcre
PS：Pcre版本不能太高，8最好，要不编译不能通过
mkdir /usr/local/pcre #创建安装目录 tar zxvf pcre-8." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://zhaoguibin.me/posts/centos7%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85nginx/" /><meta property="og:image" content="http://zhaoguibin.me/images/papermod-cover.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-12-02T15:05:34+00:00" />
<meta property="article:modified_time" content="2017-12-02T15:05:34+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://zhaoguibin.me/images/papermod-cover.png"/>

<meta name="twitter:title" content="centos7编译安装nginx"/>
<meta name="twitter:description" content="ps : nginx安装在/opt/local/nginx里
1.安装编译安装依赖的类库和包
如果需要编译MySQL和PHP，就安装这些
yum install -y make apr* autoconf automake curl curl-devel gcc gcc-c&#43;&#43; gtk&#43;-devel zlib-devel openssl openssl-devel pcre-devel gd kernel keyutils patch perl kernel-headers compat* cpp glibc libgomp libstdc&#43;&#43;-devel keyutils-libs-devel libsepol-devel libselinux-devel krb5-devel libXpm* freetype freetype-devel freetype* fontconfig fontconfig-devel libjpeg* libpng* php-common php-gd gettext gettext-devel ncurses* libtool* libxml2 libxml2-devel patch policycoreutils bison 如果只编译nginx，就安装这些
yum install gcc gcc-c&#43;&#43; autoconf automake zlib zlib-devel openssl openssl-devel pcre-devel 2.编译安装pcre
PS：Pcre版本不能太高，8最好，要不编译不能通过
mkdir /usr/local/pcre #创建安装目录 tar zxvf pcre-8."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://zhaoguibin.me/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "centos7编译安装nginx",
      "item": "http://zhaoguibin.me/posts/centos7%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85nginx/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "centos7编译安装nginx",
  "name": "centos7编译安装nginx",
  "description": "ps : nginx安装在/opt/local/nginx里\n1.安装编译安装依赖的类库和包\n如果需要编译MySQL和PHP，就安装这些\nyum install -y make apr* autoconf automake curl curl-devel gcc gcc-c++ gtk+-devel zlib-devel openssl openssl-devel pcre-devel gd kernel keyutils patch perl kernel-headers compat* cpp glibc libgomp libstdc++-devel keyutils-libs-devel libsepol-devel libselinux-devel krb5-devel libXpm* freetype freetype-devel freetype* fontconfig fontconfig-devel libjpeg* libpng* php-common php-gd gettext gettext-devel ncurses* libtool* libxml2 libxml2-devel patch policycoreutils bison 如果只编译nginx，就安装这些\nyum install gcc gcc-c++ autoconf automake zlib zlib-devel openssl openssl-devel pcre-devel 2.编译安装pcre\nPS：Pcre版本不能太高，8最好，要不编译不能通过\nmkdir /usr/local/pcre #创建安装目录 tar zxvf pcre-8.",
  "keywords": [
    "centos", "nginx"
  ],
  "articleBody": "ps : nginx安装在/opt/local/nginx里\n1.安装编译安装依赖的类库和包\n如果需要编译MySQL和PHP，就安装这些\nyum install -y make apr* autoconf automake curl curl-devel gcc gcc-c++ gtk+-devel zlib-devel openssl openssl-devel pcre-devel gd kernel keyutils patch perl kernel-headers compat* cpp glibc libgomp libstdc++-devel keyutils-libs-devel libsepol-devel libselinux-devel krb5-devel libXpm* freetype freetype-devel freetype* fontconfig fontconfig-devel libjpeg* libpng* php-common php-gd gettext gettext-devel ncurses* libtool* libxml2 libxml2-devel patch policycoreutils bison 如果只编译nginx，就安装这些\nyum install gcc gcc-c++ autoconf automake zlib zlib-devel openssl openssl-devel pcre-devel 2.编译安装pcre\nPS：Pcre版本不能太高，8最好，要不编译不能通过\nmkdir /usr/local/pcre #创建安装目录 tar zxvf pcre-8.34.tar.gz cd pcre-8.34 ./configure --prefix=/opt/local/pcre #配置 make \u0026\u0026 make install 3.配置 Nginx 安装选项\nchecking for OS + Linux 3.10.0-327.22.2.el7.x86_64 x86_64 checking for C compiler ... found + using GNU C compiler + gcc version: 4.8.5 20150623 (Red Hat 4.8.5-11) (GCC) checking for gcc -pipe switch ... found checking for -Wl,-E switch ... found checking for gcc builtin atomic operations ... found checking for C99 variadic macros ... found checking for gcc variadic macros ... found checking for gcc builtin 64 bit byteswap ... found checking for unistd.h ... found checking for inttypes.h ... found checking for limits.h ... found checking for sys/filio.h ... not found checking for sys/param.h ... found checking for sys/mount.h ... found checking for sys/statvfs.h ... found checking for crypt.h ... found checking for Linux specific features checking for epoll ... found checking for EPOLLRDHUP ... found checking for EPOLLEXCLUSIVE ... not found checking for O_PATH ... found checking for sendfile() ... found checking for sendfile64() ... found checking for sys/prctl.h ... found checking for prctl(PR_SET_DUMPABLE) ... found checking for sched_setaffinity() ... found checking for crypt_r() ... found checking for sys/vfs.h ... found checking for poll() ... found checking for /dev/poll ... not found checking for kqueue ... not found checking for crypt() ... not found checking for crypt() in libcrypt ... found checking for F_READAHEAD ... not found checking for posix_fadvise() ... found checking for O_DIRECT ... found checking for F_NOCACHE ... not found checking for directio() ... not found checking for statfs() ... found checking for statvfs() ... found checking for dlopen() ... not found checking for dlopen() in libdl ... found checking for sched_yield() ... found checking for SO_SETFIB ... not found checking for SO_REUSEPORT ... found checking for SO_ACCEPTFILTER ... not found checking for SO_BINDANY ... not found checking for IP_BIND_ADDRESS_NO_PORT ... not found checking for IP_TRANSPARENT ... found checking for IP_BINDANY ... not found checking for IP_RECVDSTADDR ... not found checking for IP_PKTINFO ... found checking for IPV6_RECVPKTINFO ... found checking for TCP_DEFER_ACCEPT ... found checking for TCP_KEEPIDLE ... found checking for TCP_FASTOPEN ... found checking for TCP_INFO ... found checking for accept4() ... found checking for eventfd() ... found checking for int size ... 4 bytes checking for long size ... 8 bytes checking for long long size ... 8 bytes checking for void * size ... 8 bytes checking for uint32_t ... found checking for uint64_t ... found checking for sig_atomic_t ... found checking for sig_atomic_t size ... 4 bytes checking for socklen_t ... found checking for in_addr_t ... found checking for in_port_t ... found checking for rlim_t ... found checking for uintptr_t ... uintptr_t found checking for system byte ordering ... little endian checking for size_t size ... 8 bytes checking for off_t size ... 8 bytes checking for time_t size ... 8 bytes checking for AF_INET6 ... found checking for setproctitle() ... not found checking for pread() ... found checking for pwrite() ... found checking for pwritev() ... found checking for sys_nerr ... found checking for localtime_r() ... found checking for posix_memalign() ... found checking for memalign() ... found checking for mmap(MAP_ANON|MAP_SHARED) ... found checking for mmap(\"/dev/zero\", MAP_SHARED) ... found checking for System V shared memory ... found checking for POSIX semaphores ... not found checking for POSIX semaphores in libpthread ... found checking for struct msghdr.msg_control ... found checking for ioctl(FIONBIO) ... found checking for struct tm.tm_gmtoff ... found checking for struct dirent.d_namlen ... not found checking for struct dirent.d_type ... found checking for sysconf(_SC_NPROCESSORS_ONLN) ... found checking for openat(), fstatat() ... found checking for getaddrinfo() ... found checking for PCRE library ... found checking for PCRE JIT support ... found checking for OpenSSL library ... found checking for zlib library ... found checking for libxslt ... found checking for libexslt ... found checking for GD library ... found checking for GD WebP support ... not found creating objs/Makefile Configuration summary + using system PCRE library + using system OpenSSL library + using system zlib library #配置地址 nginx path prefix: \"/opt/local/nginx\" nginx binary file: \"/opt/local/nginx/sbin/nginx\" nginx modules path: \"/opt/local/nginx/modules\" nginx configuration prefix: \"/opt/local/nginx/conf\" nginx configuration file: \"/opt/local/nginx/conf/nginx.conf\" nginx pid file: \"/opt/local/nginx/logs/nginx.pid\" nginx error log file: \"/opt/local/nginx/logs/error.log\" nginx http access log file: \"/opt/local/nginx/logs/access.log\" nginx http client request body temporary files: \"client_body_temp\" nginx http proxy temporary files: \"proxy_temp\" nginx http fastcgi temporary files: \"fastcgi_temp\" nginx http uwsgi temporary files: \"uwsgi_temp\" nginx http scgi temporary files: \"scgi_temp\" 编译完成之后注意nginx path prefix 到 nginx http access log file 这几行配置信息，后面需要用的到。\n4.安装 Nginx\nmake \u0026\u0026 make install 5.配置 systemd Nginx 服务和设置 Nginx 自启动\ncentos 7 中采用 systemd 来管理系统，我们来为 nginx 创建服务文件，来实现通过 systemd 来管理 nginx 。 创建 systemd 服务文件： /lib/systemd/system/nginx.service，内容如下：\n[Unit] Description=The NGINX HTTP and reverse proxy server After=syslog.target network.target remote-fs.target nss-lookup.target [Service] Type=forking PIDFile=/opt/local/nginx/logs/nginx.pid ExecStartPre=/opt/local/nginx/sbin/nginx -t ExecStart=/opt/local/nginx/sbin/nginx ExecReload=/bin/kill -s HUP $MAINPID ExecStop=/bin/kill -s QUIT $MAINPID PrivateTmp=true [Install] WantedBy=multi-user.target 这里的 PIDFile 的配置要和前面的 配置保持一致。\n设置自启动\nsystemctl enable nginx 通过 systemd 管理 nginx\nsystemctl start nginx systemctl stop nginx systemctl restart nginx systemctl reload nginx ",
  "wordCount" : "891",
  "inLanguage": "en",
  "datePublished": "2017-12-02T15:05:34Z",
  "dateModified": "2017-12-02T15:05:34Z",
  "author":{
    "@type": "Person",
    "name": "ZhaoGuibin"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://zhaoguibin.me/posts/centos7%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85nginx/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "笔记",
    "logo": {
      "@type": "ImageObject",
      "url": "http://zhaoguibin.me/assets/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://zhaoguibin.me/" accesskey="h" title="笔记 (Alt + H)">笔记</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://zhaoguibin.me/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://zhaoguibin.me/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://zhaoguibin.me/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://zhaoguibin.me/">Home</a>&nbsp;»&nbsp;<a href="http://zhaoguibin.me/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      centos7编译安装nginx
    </h1>
    <div class="post-meta"><span title='2017-12-02 15:05:34 +0000 UTC'>December 2, 2017</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;ZhaoGuibin

</div>
  </header> 

  <div class="post-content"><p><strong>ps : nginx安装在/opt/local/nginx里</strong></p>
<p>1.安装编译安装依赖的类库和包</p>
<p>如果需要编译MySQL和PHP，就安装这些</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yum install -y make apr* autoconf automake curl curl-devel gcc gcc-c++ gtk+-devel zlib-devel openssl openssl-devel pcre-devel gd kernel keyutils patch perl kernel-headers compat* cpp glibc libgomp libstdc++-devel keyutils-libs-devel libsepol-devel libselinux-devel krb5-devel libXpm* freetype freetype-devel freetype* fontconfig fontconfig-devel libjpeg* libpng* php-common php-gd gettext gettext-devel ncurses* libtool* libxml2 libxml2-devel patch policycoreutils bison
</span></span></code></pre></div><!-- more -->
<p>如果只编译nginx，就安装这些</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yum install gcc gcc-c++ autoconf automake zlib zlib-devel openssl openssl-devel pcre-devel
</span></span></code></pre></div><p>2.编译安装pcre</p>
<p><strong>PS：Pcre版本不能太高，8最好，要不编译不能通过</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir /usr/local/pcre <span class="c1">#创建安装目录</span>
</span></span><span class="line"><span class="cl">tar zxvf pcre-8.34.tar.gz
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> pcre-8.34
</span></span><span class="line"><span class="cl">./configure --prefix<span class="o">=</span>/opt/local/pcre <span class="c1">#配置</span>
</span></span><span class="line"><span class="cl">make <span class="o">&amp;&amp;</span> make install
</span></span></code></pre></div><p>3.配置 Nginx 安装选项</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">checking <span class="k">for</span> OS
</span></span><span class="line"><span class="cl"> + Linux 3.10.0-327.22.2.el7.x86_64 x86_64
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> C compiler ... found
</span></span><span class="line"><span class="cl"> + using GNU C compiler
</span></span><span class="line"><span class="cl"> + gcc version: 4.8.5 <span class="m">20150623</span> <span class="o">(</span>Red Hat 4.8.5-11<span class="o">)</span> <span class="o">(</span>GCC<span class="o">)</span>
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> gcc -pipe switch ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> -Wl,-E switch ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> gcc <span class="nb">builtin</span> atomic operations ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> C99 variadic macros ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> gcc variadic macros ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> gcc <span class="nb">builtin</span> <span class="m">64</span> bit byteswap ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> unistd.h ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> inttypes.h ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> limits.h ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sys/filio.h ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sys/param.h ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sys/mount.h ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sys/statvfs.h ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> crypt.h ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> Linux specific features
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> epoll ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> EPOLLRDHUP ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> EPOLLEXCLUSIVE ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> O_PATH ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sendfile<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sendfile64<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sys/prctl.h ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> prctl<span class="o">(</span>PR_SET_DUMPABLE<span class="o">)</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sched_setaffinity<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> crypt_r<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sys/vfs.h ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> poll<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> /dev/poll ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> kqueue ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> crypt<span class="o">()</span> ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> crypt<span class="o">()</span> in libcrypt ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> F_READAHEAD ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> posix_fadvise<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> O_DIRECT ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> F_NOCACHE ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> directio<span class="o">()</span> ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> statfs<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> statvfs<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> dlopen<span class="o">()</span> ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> dlopen<span class="o">()</span> in libdl ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sched_yield<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> SO_SETFIB ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> SO_REUSEPORT ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> SO_ACCEPTFILTER ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> SO_BINDANY ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> IP_BIND_ADDRESS_NO_PORT ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> IP_TRANSPARENT ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> IP_BINDANY ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> IP_RECVDSTADDR ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> IP_PKTINFO ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> IPV6_RECVPKTINFO ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> TCP_DEFER_ACCEPT ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> TCP_KEEPIDLE ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> TCP_FASTOPEN ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> TCP_INFO ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> accept4<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> eventfd<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> int size ... <span class="m">4</span> bytes
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> long size ... <span class="m">8</span> bytes
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> long long size ... <span class="m">8</span> bytes
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> void * size ... <span class="m">8</span> bytes
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> uint32_t ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> uint64_t ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sig_atomic_t ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sig_atomic_t size ... <span class="m">4</span> bytes
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> socklen_t ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> in_addr_t ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> in_port_t ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> rlim_t ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> uintptr_t ... uintptr_t found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> system byte ordering ... little endian
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> size_t size ... <span class="m">8</span> bytes
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> off_t size ... <span class="m">8</span> bytes
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> time_t size ... <span class="m">8</span> bytes
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> AF_INET6 ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> setproctitle<span class="o">()</span> ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> pread<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> pwrite<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> pwritev<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sys_nerr ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> localtime_r<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> posix_memalign<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> memalign<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> mmap<span class="o">(</span>MAP_ANON<span class="p">|</span>MAP_SHARED<span class="o">)</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> mmap<span class="o">(</span><span class="s2">&#34;/dev/zero&#34;</span>, MAP_SHARED<span class="o">)</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> System V shared memory ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> POSIX semaphores ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> POSIX semaphores in libpthread ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> struct msghdr.msg_control ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> ioctl<span class="o">(</span>FIONBIO<span class="o">)</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> struct tm.tm_gmtoff ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> struct dirent.d_namlen ... not found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> struct dirent.d_type ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> sysconf<span class="o">(</span>_SC_NPROCESSORS_ONLN<span class="o">)</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> openat<span class="o">()</span>, fstatat<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> getaddrinfo<span class="o">()</span> ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> PCRE library ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> PCRE JIT support ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> OpenSSL library ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> zlib library ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> libxslt ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> libexslt ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> GD library ... found
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> GD WebP support ... not found
</span></span><span class="line"><span class="cl">creating objs/Makefile
</span></span><span class="line"><span class="cl">Configuration summary
</span></span><span class="line"><span class="cl"> + using system PCRE library
</span></span><span class="line"><span class="cl"> + using system OpenSSL library
</span></span><span class="line"><span class="cl"> + using system zlib library
</span></span><span class="line"><span class="cl"> <span class="c1">#配置地址</span>
</span></span><span class="line"><span class="cl"> nginx path prefix: <span class="s2">&#34;/opt/local/nginx&#34;</span>
</span></span><span class="line"><span class="cl"> nginx binary file: <span class="s2">&#34;/opt/local/nginx/sbin/nginx&#34;</span>
</span></span><span class="line"><span class="cl"> nginx modules path: <span class="s2">&#34;/opt/local/nginx/modules&#34;</span>
</span></span><span class="line"><span class="cl"> nginx configuration prefix: <span class="s2">&#34;/opt/local/nginx/conf&#34;</span>
</span></span><span class="line"><span class="cl"> nginx configuration file: <span class="s2">&#34;/opt/local/nginx/conf/nginx.conf&#34;</span>
</span></span><span class="line"><span class="cl"> nginx pid file: <span class="s2">&#34;/opt/local/nginx/logs/nginx.pid&#34;</span>
</span></span><span class="line"><span class="cl"> nginx error log file: <span class="s2">&#34;/opt/local/nginx/logs/error.log&#34;</span>
</span></span><span class="line"><span class="cl"> nginx http access log file: <span class="s2">&#34;/opt/local/nginx/logs/access.log&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> nginx http client request body temporary files: <span class="s2">&#34;client_body_temp&#34;</span>
</span></span><span class="line"><span class="cl"> nginx http proxy temporary files: <span class="s2">&#34;proxy_temp&#34;</span>
</span></span><span class="line"><span class="cl"> nginx http fastcgi temporary files: <span class="s2">&#34;fastcgi_temp&#34;</span>
</span></span><span class="line"><span class="cl"> nginx http uwsgi temporary files: <span class="s2">&#34;uwsgi_temp&#34;</span>
</span></span><span class="line"><span class="cl"> nginx http scgi temporary files: <span class="s2">&#34;scgi_temp&#34;</span>
</span></span></code></pre></div><p>编译完成之后注意nginx path prefix 到 nginx http access log file 这几行配置信息，后面需要用的到。</p>
<p>4.安装 Nginx</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make <span class="o">&amp;&amp;</span> make install
</span></span></code></pre></div><p>5.配置 systemd Nginx 服务和设置 Nginx 自启动</p>
<p>centos 7 中采用 systemd 来管理系统，我们来为 nginx 创建服务文件，来实现通过 systemd 来管理 nginx 。
创建 systemd 服务文件： /lib/systemd/system/nginx.service，内容如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>Unit<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Description</span><span class="o">=</span>The NGINX HTTP and reverse proxy server
</span></span><span class="line"><span class="cl"><span class="nv">After</span><span class="o">=</span>syslog.target network.target remote-fs.target nss-lookup.target
</span></span><span class="line"><span class="cl"><span class="o">[</span>Service<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Type</span><span class="o">=</span>forking
</span></span><span class="line"><span class="cl"><span class="nv">PIDFile</span><span class="o">=</span>/opt/local/nginx/logs/nginx.pid
</span></span><span class="line"><span class="cl"><span class="nv">ExecStartPre</span><span class="o">=</span>/opt/local/nginx/sbin/nginx -t
</span></span><span class="line"><span class="cl"><span class="nv">ExecStart</span><span class="o">=</span>/opt/local/nginx/sbin/nginx
</span></span><span class="line"><span class="cl"><span class="nv">ExecReload</span><span class="o">=</span>/bin/kill -s HUP <span class="nv">$MAINPID</span>
</span></span><span class="line"><span class="cl"><span class="nv">ExecStop</span><span class="o">=</span>/bin/kill -s QUIT <span class="nv">$MAINPID</span>
</span></span><span class="line"><span class="cl"><span class="nv">PrivateTmp</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>Install<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</span></span></code></pre></div><p>这里的 PIDFile 的配置要和前面的 配置保持一致。</p>
<p>设置自启动</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl <span class="nb">enable</span> nginx
</span></span></code></pre></div><p>通过 systemd 管理 nginx</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl start nginx
</span></span><span class="line"><span class="cl">systemctl stop nginx
</span></span><span class="line"><span class="cl">systemctl restart nginx
</span></span><span class="line"><span class="cl">systemctl reload nginx
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://zhaoguibin.me/tags/centos/">centos</a></li>
      <li><a href="http://zhaoguibin.me/tags/nginx/">nginx</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://zhaoguibin.me/posts/mysql%E4%BD%BF%E7%94%A8symbolic-links%E4%BB%A5%E6%94%AF%E6%8C%81%E6%95%B0%E6%8D%AE%E5%88%86%E5%8C%BA%E5%AD%98%E5%82%A8/">
    <span class="title">« Prev</span>
    <br>
    <span>MySQL使用Symbolic-Links以支持数据分区存储</span>
  </a>
  <a class="next" href="http://zhaoguibin.me/posts/centos6-5%E5%BC%80%E5%90%AF-%E5%85%B3%E9%97%AD%E7%AB%AF%E5%8F%A3/">
    <span class="title">Next »</span>
    <br>
    <span>centos6-5开启-关闭端口</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="http://zhaoguibin.me/">笔记</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
